<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <!-- LOAD STYLESHEETS -->
        <link rel="stylesheet" href="stylesheets/style.css" type="text/css" media="screen" charset="utf-8">
        <link rel="stylesheet" href="stylesheets/screen.css" type="text/css" media="screen, projection">
    	<link rel="stylesheet" href="stylesheets/wowza.css" type="text/css" />
        <!-- LOAD SCRIPTS -->
        <script type="text/javascript" charset="utf-8" src="../dist/clappr.js"></script>
        <script type="text/javascript" charset="utf-8" src="j/main.js"></script>
        <!-- SET FAVICON -->
        <link rel="shortcut icon" type="image/png" href="i/favico.png">

    	<title id="title"></title>
    	<script>
    		//split the URL by "/", grab last piece ("PAGENAME.html")
    		var pageTitle = window.location.href.toString().split("/");
    		//split by ".", grab first piece ("PAGENAME")
    		pageTitle = pageTitle[pageTitle.length-1].split(".")[0];

        //CHANGE THIS. THIS IT THE TITLE OF THE PAGE
        var pageName = "Board of Regents - Live Stream";  //title the appears above video and on the tab

        function getPageTitle() {
            return pageTitle;
        }
    	</script>

    	<!-- check to see if HLS is supported -->
        <script>
            function supports_hls_video()
            {
                if (videoObj.canPlayType)
                {
                    if (videoObj.canPlayType('application/x-mpegURL'))
                    {
                        if(videoObj.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"') )
                        {
                            return true;
                        }
                    }
                }
                return false;
            }
        </script>
    </head>

    <body>
    	<div class="container">
    		<!-- HEADER -->
            <div class="span-18">
                <h1 id="header"></h1>
          	</div>

            <div class="span-6 last">
                <img src="i/Header_emu-logo.png" class="logo" width="227" height="84"/>
    		</div>
            <hr class="heading">
    		<!-- END HEADER -->

            <div class="span-16">
            	<!-- if HLS is NOT supported -->
            	<div id="notsupported">
                    <!-- placeholder for player -->
                    <div id="player-wrapper" class="player"></div>
            	</div>

            	<!-- if HLS is supported -->
            	<div id="supported">
                    <div>
                        <style>
                            video {
                                background-color: #000000;
                            }
                        </style>
                        <video id="videoObj" x-webkit-airplay="allow" width="640" height="480"  onerror="failed(event)"></video>
                    </div>
                    <table style="display:none;">
                        <tr>
                            <td>
                                <button id="playObj" type="button" style="width:60px" onClick="JavaScript:playControl()" disabled="disabled">Pause</button>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <b>Stream:</b>
                            </td>
                            <td>
                                <input id="connectStr" size = "80" type="text" placeholder="" value=""/>
                                <script>
                                    //set HLS link to be the same as the page title
                                    document.getElementById("connectStr").value = connectStr;
                                </script>
                                <button id="connectObj" type="button" style="width:80px" onClick="JavaScript:connect()">Connect</button>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <b>Status:</b>
                            </td>
                            <td>
                                <label id="statusStr" size = "100" type="text" placeholder="" value=""></label>
                            </td>
                        </tr>
                    </table>
            	</div>
    			<!-- Player checking -->
    			<script>
    													//check if HLS video is supported
    				if ( supports_hls_video() ) {		//if HLS is supported
    					notsupported.style.display="none";
                        playControl();
    				}
    				else {								//if HLS ins't supported
    					supported.style.display="none";
    					videoObj.style.display="none";
                        loadFlashPlayer();
    				}

    				function connect() {
    					if(connectObj.textContent == "Disconnect") {
    						connectObj.textContent = "Connect";
    						playObj.disabled = "disabled";
    						playObj.textContent = 'Pause';
    						videoObj.pause();
    						videoObj.src=null;
    						videoObj.load();
    						statusStr.textContent = "";
    					}
    					else {
    						connectObj.textContent = "Disconnect";
    						playObj.disabled = "";
    						statusStr.textContent = "";
    						videoObj.src = connectStr.value;
    						videoObj.load();
    					}
    				}

    				function playControl() {
    					if (videoObj.paused == false) {
    						videoObj.pause();
    						playObj.textContent = 'Play';
    					}
    					else {
    						videoObj.play();
    						statusStr.textContent="Playing";
    						playObj.textContent = 'Pause';
    					}
    				}
    				function failed(e) {
    					// video playback failed - show a message saying why
    					switch (e.target.error.code) {
    						case e.target.error.MEDIA_ERR_ABORTED:
    						statusStr.textContent='You aborted the video playback.';
    						break;
    						case e.target.error.MEDIA_ERR_NETWORK:
    						statusStr.textContent='A network error caused the video download to fail part-way.';
    						break;
    						case e.target.error.MEDIA_ERR_DECODE:
    						statusStr.textContent='The video playback was aborted due to a corruption problem or because the video used features your browser did not support.';
    						break;
    						case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:
    						statusStr.textContent= 'The video could not be loaded, either because the server or network failed or because the format is not supported.';
    						break;
    						default:
    						statusStr.textContent = 'An unknown error occurred.';
    						break;
    					}
    				}
    			</script>
            </div>


    		<!-- SIDEBAR --><h3>To play on an iOS device</h3>
                <h3><a href="" id="ios link">Click Here!</a></h3>
                <script>
                	//set iOS link to be the same as the page title
                	document.getElementById("ios link").href = connectStr;

                    //set title of page
                    document.getElementById("title").innerHTML = pageName;
                    document.getElementById("header").innerHTML = pageName;
                </script>
    		<!-- FOOTER -->
          	<div class="span-24">
                <hr class="heading">
                <div class="span-1">
                	<img src="i/icon-company.png" width="34" height="35" />
                </div>
                <div class="span-23 last copyright">
                    &nbsp;&#169;&nbsp;2015 Wowza Media Systems, LLC. All rights reserved.
                </div>
            </div>
    		<!-- END FOOTER -->
    	</div>
    </body>
</html>
